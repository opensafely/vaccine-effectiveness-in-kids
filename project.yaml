version: '3.0'

expectations:

  population_size: 100000

actions:

  ## # # # # # # # # # # # # # # # # # # # 
  ## DO NOT EDIT project.yaml DIRECTLY 
  ## This file is created by create-project.R 
  ## Edit and run create-project.R to update the project.yaml 
  ## # # # # # # # # # # # # # # # # # # # 
  ##   
  ## # # # # # # # # # # # # # # # # # # # 
  ## Over 12s cohort 
  ## # # # # # # # # # # # # # # # # # # # 
  ## # # # # # # # # # # # # # # # # # # # 
  ## Extract and match 

  extract_treated_over12_vax1:
    run: cohortextractor:latest generate_cohort --study-definition study_definition_treated
      --output-file output/vax1/over12/extract/input_treated.feather --param cohort=over12
      --param vaxn=vax1
    outputs:
      highly_sensitive:
        extract: output/vax1/over12/extract/input_treated.feather

  process_treated_over12_vax1:
    run: r:latest analysis/treated/process_treated.R over12 vax1
    needs:
    - extract_treated_over12_vax1
    outputs:
      highly_sensitive:
        rds: output/vax1/over12/treated/*.rds
      moderately_sensitive:
        csv: output/vax1/over12/treated/*.csv
